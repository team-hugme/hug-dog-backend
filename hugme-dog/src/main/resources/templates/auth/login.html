<form id="loginForm">
    <input type="text" id="userId" placeholder="아이디">
    <input type="password" id="password" placeholder="비밀번호">
    <button type="submit">로그인</button>
    <a th:href="@{/v1/auth/signup}">회원가입</a>
</form>
<div id="loginError" style="color:red;"></div>

<script>
    document.getElementById('loginForm').addEventListener('submit', async function(e){
        e.preventDefault();
        const userId = document.getElementById('userId').value;
        const password = document.getElementById('password').value;

        try {
            const response = await fetch('/v1/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ userId, password })
            });

            const result = await response.json();

            if(result.code === "OK"){
                localStorage.setItem('accessToken', result.data.accessToken);
                localStorage.setItem('refreshToken', result.data.refreshToken);
                window.location.href = '/v1/auth/main';
            } else {
                document.getElementById('loginError').innerText = `로그인 실패: ${result.message}`;
            }
        } catch(err){
            console.error(err);
            document.getElementById('loginError').innerText = '서버와 연결할 수 없습니다.';
        }
    });
</script>
